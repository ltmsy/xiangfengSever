# åå°ç®¡ç†é…ç½®æ¥å£æ–‡æ¡£

## ğŸ“‹ æ¦‚è¿°

æœ¬æ–‡æ¡£æè¿°äº†åå°ç®¡ç†ç³»ç»Ÿçš„é…ç½®ç®¡ç†ç›¸å…³æ¥å£ï¼Œæ”¯æŒæŒ‰åˆ†ç±»ç®¡ç†å„ç§ç³»ç»Ÿé…ç½®ï¼Œä¸ºå‰ç«¯æä¾›tabåˆ‡æ¢å¼çš„é…ç½®ç®¡ç†ç•Œé¢ã€‚

## ğŸ” æƒé™è¦æ±‚

- æ‰€æœ‰ç®¡ç†æ¥å£éœ€è¦è¶…çº§ç®¡ç†å‘˜æƒé™
- å…¬å¼€é…ç½®æ¥å£æ— éœ€æƒé™éªŒè¯
- ä½¿ç”¨JWT Bearer Tokenè®¤è¯

## ğŸŒ åŸºç¡€ä¿¡æ¯

- **åŸºç¡€URL**: `/v1/manager`
- **è®¤è¯æ–¹å¼**: Bearer Token
- **æ•°æ®æ ¼å¼**: JSON
- **å­—ç¬¦ç¼–ç **: UTF-8

## ğŸ“š é…ç½®åˆ†ç±»

ç³»ç»Ÿé¢„å®šä¹‰äº†ä»¥ä¸‹é…ç½®åˆ†ç±»ï¼š

| åˆ†ç±»é”® | åˆ†ç±»åç§° | è¯´æ˜ |
|--------|----------|------|
| `group` | ç¾¤ç»„é…ç½® | ç¾¤ç»„ç›¸å…³åŠŸèƒ½é…ç½® |
| `system` | ç³»ç»Ÿé…ç½® | ç³»ç»ŸåŸºç¡€é…ç½® |
| `security` | å®‰å…¨é…ç½® | å®‰å…¨ç›¸å…³é…ç½® |
| `notification` | é€šçŸ¥é…ç½® | é€šçŸ¥ç›¸å…³é…ç½® |
| `ui` | ç•Œé¢é…ç½® | ç”¨æˆ·ç•Œé¢ç›¸å…³é…ç½® |
| `message` | æ¶ˆæ¯é…ç½® | æ¶ˆæ¯åŠŸèƒ½ç›¸å…³é…ç½® |
| `file` | æ–‡ä»¶é…ç½® | æ–‡ä»¶ç®¡ç†ç›¸å…³é…ç½® |
| `robot` | æœºå™¨äººé…ç½® | æœºå™¨äººåŠŸèƒ½ç›¸å…³é…ç½® |
| `statistics` | ç»Ÿè®¡é…ç½® | ç»Ÿè®¡åŠŸèƒ½ç›¸å…³é…ç½® |



## ğŸ”Œ APIæ¥å£è¯¦æƒ…

### 1. è·å–é…ç½®åˆ†ç±»åˆ—è¡¨

**æ¥å£åœ°å€**: `GET /config/categories`

**æ¥å£æè¿°**: è·å–æ‰€æœ‰é…ç½®åˆ†ç±»ä¿¡æ¯ï¼Œç”¨äºå‰ç«¯tabåˆ‡æ¢

**è¯·æ±‚å‚æ•°**: æ— 

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "category": "group",
      "category_name": "ç¾¤ç»„é…ç½®",
      "count": 8
    },
    {
      "category": "system",
      "category_name": "ç³»ç»Ÿé…ç½®",
      "count": 8
    }
  ]
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `category`: é…ç½®åˆ†ç±»é”®
- `category_name`: é…ç½®åˆ†ç±»æ˜¾ç¤ºåç§°
- `count`: è¯¥åˆ†ç±»ä¸‹çš„é…ç½®é¡¹æ•°é‡

---

### 2. è·å–æ‰€æœ‰é…ç½®ï¼ˆæŒ‰åˆ†ç±»åˆ†ç»„ï¼‰

**æ¥å£åœ°å€**: `GET /config/list`

**æ¥å£æè¿°**: è·å–æ‰€æœ‰é…ç½®é¡¹ï¼ŒæŒ‰åˆ†ç±»åˆ†ç»„è¿”å›ï¼Œç”¨äºå‰ç«¯tabé¡µé¢å±•ç¤º

**è¯·æ±‚å‚æ•°**: æ— 

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": [
    {
      "category": "group",
      "category_name": "ç¾¤ç»„é…ç½®",
      "configs": [
        {
          "id": 1,
          "config_key": "group.notify_member_join",
          "config_value": "1",
          "config_type": "boolean",
          "description": "ç¾¤æˆå‘˜åŠ å…¥æ—¶æ˜¯å¦é€šçŸ¥å…¶ä»–æˆå‘˜",
          "category": "group",
          "is_editable": 1,
          "is_public": 1,
          "sort_order": 100,
          "version": 1,
          "created_at": "2025-01-17 23:22:43",
          "updated_at": "2025-01-17 23:22:43",
          "created_by": "system",
          "updated_by": "system"
        }
      ]
    }
  ]
}
```

---

### 3. æ ¹æ®åˆ†ç±»è·å–é…ç½®

**æ¥å£åœ°å€**: `GET /config/category/{category}`

**æ¥å£æè¿°**: æ ¹æ®æŒ‡å®šåˆ†ç±»è·å–è¯¥åˆ†ç±»ä¸‹çš„æ‰€æœ‰é…ç½®é¡¹

**è·¯å¾„å‚æ•°**:
- `category`: é…ç½®åˆ†ç±»ï¼ˆå¿…å¡«ï¼‰

**æ”¯æŒçš„åˆ†ç±»å€¼**: `group`, `system`, `security`, `notification`, `ui`, `message`, `file`, `robot`, `statistics`

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "category": "group",
    "category_name": "ç¾¤ç»„é…ç½®",
    "configs": [
      {
        "id": 1,
        "config_key": "group.notify_member_join",
        "config_value": "1",
        "config_type": "boolean",
        "description": "ç¾¤æˆå‘˜åŠ å…¥æ—¶æ˜¯å¦é€šçŸ¥å…¶ä»–æˆå‘˜",
        "is_editable": 1,
        "is_public": 1
      }
    ]
  }
}
```

---

### 4. æ›´æ–°å•ä¸ªé…ç½®

**æ¥å£åœ°å€**: `PUT /config/update`

**æ¥å£æè¿°**: æ›´æ–°æŒ‡å®šé…ç½®é¡¹çš„å€¼

**è¯·æ±‚å‚æ•°**:
```json
{
  "config_key": "group.notify_member_join",
  "config_value": "0"
}
```

**è¯·æ±‚å­—æ®µè¯´æ˜**:
- `config_key`: é…ç½®é”®ï¼ˆå¿…å¡«ï¼‰
- `config_value`: é…ç½®å€¼ï¼ˆå¿…å¡«ï¼‰

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success"
}
```

**æ³¨æ„äº‹é¡¹**:
- åªèƒ½æ›´æ–° `is_editable = 1` çš„é…ç½®é¡¹
- é…ç½®å€¼ä¼šæ ¹æ®é…ç½®ç±»å‹è¿›è¡ŒéªŒè¯
- æ›´æ–°åç‰ˆæœ¬å·ä¼šè‡ªåŠ¨é€’å¢

---

### 5. æ‰¹é‡æ›´æ–°é…ç½®

**æ¥å£åœ°å€**: `PUT /config/batch-update`

**æ¥å£æè¿°**: æ‰¹é‡æ›´æ–°å¤šä¸ªé…ç½®é¡¹çš„å€¼

**è¯·æ±‚å‚æ•°**:
```json
{
  "configs": [
    {
      "config_key": "group.notify_member_join",
      "config_value": "1"
    },
    {
      "config_key": "group.notify_member_leave",
      "config_value": "1"
    }
  ]
}
```

**è¯·æ±‚å­—æ®µè¯´æ˜**:
- `configs`: é…ç½®é¡¹æ•°ç»„ï¼ˆå¿…å¡«ï¼Œè‡³å°‘1é¡¹ï¼‰
  - `config_key`: é…ç½®é”®ï¼ˆå¿…å¡«ï¼‰
  - `config_value`: é…ç½®å€¼ï¼ˆå¿…å¡«ï¼‰

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success"
}
```

**æ³¨æ„äº‹é¡¹**:
- ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡ç¡®ä¿æ‰¹é‡æ›´æ–°çš„ä¸€è‡´æ€§
- æ‰€æœ‰é…ç½®é¡¹å¿…é¡»å­˜åœ¨ä¸”å¯ç¼–è¾‘
- é…ç½®å€¼ä¼šè¿›è¡Œç±»å‹éªŒè¯

---

### 6. æœç´¢é…ç½®

**æ¥å£åœ°å€**: `POST /config/search`

**æ¥å£æè¿°**: æ ¹æ®å…³é”®è¯å’Œåˆ†ç±»æœç´¢é…ç½®é¡¹

**è¯·æ±‚å‚æ•°**:
```json
{
  "keyword": "ç¾¤ç»„",
  "category": "group",
  "page": 1,
  "page_size": 20
}
```

**è¯·æ±‚å­—æ®µè¯´æ˜**:
- `keyword`: æœç´¢å…³é”®è¯ï¼ˆå¯é€‰ï¼‰
- `category`: é…ç½®åˆ†ç±»ï¼ˆå¯é€‰ï¼‰
- `page`: é¡µç ï¼ˆå¿…å¡«ï¼Œæœ€å°1ï¼‰
- `page_size`: æ¯é¡µæ•°é‡ï¼ˆå¿…å¡«ï¼Œ1-100ï¼‰

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "configs": [
      {
        "id": 1,
        "config_key": "group.notify_member_join",
        "config_value": "1",
        "config_type": "boolean",
        "description": "ç¾¤æˆå‘˜åŠ å…¥æ—¶æ˜¯å¦é€šçŸ¥å…¶ä»–æˆå‘˜"
      }
    ],
    "total": 1,
    "page": 1,
    "page_size": 20
  }
}
```

---

### 7. æ–°å¢é…ç½®é¡¹

**æ¥å£åœ°å€**: `POST /config/create`

**æ¥å£æè¿°**: åˆ›å»ºæ–°çš„é…ç½®é¡¹

**è¯·æ±‚å‚æ•°**:
```json
{
  "config_key": "system.new_feature",
  "config_value": "1",
  "config_type": "boolean",
  "description": "æ–°åŠŸèƒ½å¼€å…³",
  "category": "system",
  "is_editable": 1,
  "is_public": 0,
  "sort_order": 250
}
```

**è¯·æ±‚å­—æ®µè¯´æ˜**:
- `config_key`: é…ç½®é”®ï¼ˆå¿…å¡«ï¼Œå…¨å±€å”¯ä¸€ï¼‰
- `config_value`: é…ç½®å€¼ï¼ˆå¿…å¡«ï¼‰
- `config_type`: é…ç½®ç±»å‹ï¼ˆå¿…å¡«ï¼Œæ”¯æŒï¼šstringã€numberã€booleanã€jsonã€imageï¼‰
- `description`: é…ç½®æè¿°ï¼ˆå¿…å¡«ï¼‰
- `category`: é…ç½®åˆ†ç±»ï¼ˆå¿…å¡«ï¼‰
- `is_editable`: æ˜¯å¦å¯ç¼–è¾‘ï¼ˆå¯é€‰ï¼Œé»˜è®¤1ï¼‰
- `is_public`: æ˜¯å¦å…¬å¼€ï¼ˆå¯é€‰ï¼Œé»˜è®¤0ï¼‰
- `sort_order`: æ’åºé¡ºåºï¼ˆå¯é€‰ï¼Œé»˜è®¤0ï¼‰

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "id": 25,
    "config_key": "system.new_feature",
    "config_value": "1",
    "config_type": "boolean",
    "description": "æ–°åŠŸèƒ½å¼€å…³",
    "category": "system",
    "is_editable": 1,
    "is_public": 0,
    "sort_order": 250,
    "version": 1,
    "created_at": "2025-01-20 10:00:00",
    "updated_at": "2025-01-20 10:00:00",
    "created_by": "admin",
    "updated_by": "admin"
  }
}
```

**æ³¨æ„äº‹é¡¹**:
- é…ç½®é”®å¿…é¡»å…¨å±€å”¯ä¸€
- é…ç½®å€¼ä¼šæ ¹æ®é…ç½®ç±»å‹è¿›è¡ŒéªŒè¯
- åˆ›å»ºè€…ä¿¡æ¯ä¼šè‡ªåŠ¨è®°å½•

---

### 8. åˆ é™¤é…ç½®é¡¹

**æ¥å£åœ°å€**: `DELETE /config/delete/{config_key}`

**æ¥å£æè¿°**: åˆ é™¤æŒ‡å®šçš„é…ç½®é¡¹

**è·¯å¾„å‚æ•°**:
- `config_key`: é…ç½®é”®ï¼ˆå¿…å¡«ï¼‰

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success"
}
```

**æ³¨æ„äº‹é¡¹**:
- åˆ é™¤æ“ä½œä¸å¯æ¢å¤
- åªèƒ½åˆ é™¤ `is_editable = 1` çš„é…ç½®é¡¹
- ç³»ç»Ÿæ ¸å¿ƒé…ç½®ä¸å…è®¸åˆ é™¤

---

### 9. æ‰¹é‡åˆ é™¤é…ç½®é¡¹

**æ¥å£åœ°å€**: `DELETE /config/batch-delete`

**æ¥å£æè¿°**: æ‰¹é‡åˆ é™¤å¤šä¸ªé…ç½®é¡¹

**è¯·æ±‚å‚æ•°**:
```json
{
  "config_keys": [
    "system.temp_config1",
    "system.temp_config2"
  ]
}
```

**è¯·æ±‚å­—æ®µè¯´æ˜**:
- `config_keys`: è¦åˆ é™¤çš„é…ç½®é”®æ•°ç»„ï¼ˆå¿…å¡«ï¼Œè‡³å°‘1é¡¹ï¼‰

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "deleted_count": 2,
    "failed_keys": []
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- `deleted_count`: æˆåŠŸåˆ é™¤çš„é…ç½®é¡¹æ•°é‡
- `failed_keys`: åˆ é™¤å¤±è´¥çš„é…ç½®é”®åˆ—è¡¨

**æ³¨æ„äº‹é¡¹**:
- ä½¿ç”¨æ•°æ®åº“äº‹åŠ¡ç¡®ä¿æ‰¹é‡åˆ é™¤çš„ä¸€è‡´æ€§
- åªèƒ½åˆ é™¤å¯ç¼–è¾‘çš„é…ç½®é¡¹
- è¿”å›åˆ é™¤ç»“æœç»Ÿè®¡

---

### 10. è·å–å…¬å¼€é…ç½®

**æ¥å£åœ°å€**: `GET /config/public`

**æ¥å£æè¿°**: è·å–æ‰€æœ‰å…¬å¼€çš„é…ç½®é¡¹ï¼Œæ— éœ€æƒé™éªŒè¯

**è¯·æ±‚å‚æ•°**: æ— 

**å“åº”ç¤ºä¾‹**:
```json
{
  "code": 200,
  "message": "success",
  "data": {
    "system.site_name": "å”åƒ§å¨å¨",
    "system.site_logo": "/assets/images/logo.png",
    "ui.theme": "light"
  }
}
```

**å“åº”å­—æ®µè¯´æ˜**:
- è¿”å› `is_public = 1` çš„é…ç½®é¡¹
- ä»¥ `config_key: config_value` çš„é”®å€¼å¯¹å½¢å¼è¿”å›

## ğŸ“Š é…ç½®æ•°æ®ç±»å‹

### 1. booleanç±»å‹
- æ”¯æŒå€¼: `"0"`, `"1"`, `"true"`, `"false"`
- ç¤ºä¾‹: å¼€å…³ç±»é…ç½®

### 2. numberç±»å‹
- æ”¯æŒå€¼: æ•°å­—å­—ç¬¦ä¸²
- ç¤ºä¾‹: æ•°é‡é™åˆ¶ã€æ—¶é—´è®¾ç½®

### 3. stringç±»å‹
- æ”¯æŒå€¼: ä»»æ„å­—ç¬¦ä¸²
- ç¤ºä¾‹: åç§°ã€æè¿°ã€è·¯å¾„

### 4. imageç±»å‹ â­ æ–°å¢
- æ”¯æŒå€¼: å›¾ç‰‡æ–‡ä»¶è·¯å¾„æˆ–URL
- ç¤ºä¾‹: Logoã€å¤´åƒã€èƒŒæ™¯å›¾ç­‰å›¾ç‰‡é…ç½®
- éªŒè¯è§„åˆ™: è‡ªåŠ¨éªŒè¯å›¾ç‰‡è·¯å¾„æ ¼å¼

### 5. jsonç±»å‹
- æ”¯æŒå€¼: JSONæ ¼å¼å­—ç¬¦ä¸²
- ç¤ºä¾‹: å¤æ‚é…ç½®å¯¹è±¡

## ğŸ”’ æƒé™æ§åˆ¶

### é…ç½®æƒé™çº§åˆ«

1. **åªè¯»é…ç½®** (`is_editable = 0`)
   - æ™®é€šç®¡ç†å‘˜åªèƒ½æŸ¥çœ‹
   - è¶…çº§ç®¡ç†å‘˜ä¹Ÿæ— æ³•ä¿®æ”¹

2. **å¯ç¼–è¾‘é…ç½®** (`is_editable = 1`)
   - è¶…çº§ç®¡ç†å‘˜å¯ä»¥ä¿®æ”¹
   - æ”¯æŒå•ä¸ªå’Œæ‰¹é‡æ›´æ–°

3. **å…¬å¼€é…ç½®** (`is_public = 1`)
   - å‰ç«¯å¯ä»¥è·å–
   - æ— éœ€æƒé™éªŒè¯

4. **ç§æœ‰é…ç½®** (`is_public = 0`)
   - ä»…åå°å¯è§
   - éœ€è¦ç®¡ç†å‘˜æƒé™

## ğŸ“ é…ç½®é¡¹ç¤ºä¾‹

### ç¾¤ç»„é…ç½®ç¤ºä¾‹
```json
{
  "group.notify_member_join": "1",
  "group.notify_member_leave": "1",
  "group.notify_member_kick": "1",
  "group.new_member_see_history": "1",
  "group.allow_member_invite": "1",
  "group.allow_member_pinned_message": "0",
  "group.max_member_count": "500",
  "group.auto_delete_inactive_days": "30"
}
```

### ç³»ç»Ÿé…ç½®ç¤ºä¾‹
```json
{
  "system.site_name": "å”åƒ§å¨å¨",
  "system.site_logo": "/assets/images/logo.png",
  "system.site_favicon": "/assets/images/favicon.ico",
  "system.default_avatar": "/assets/images/default_avatar.png",
  "system.welcome_message": "æ¬¢è¿ä½¿ç”¨å”åƒ§å¨å¨ï¼",
  "system.maintenance_mode": "0",
  "system.maintenance_message": "ç³»ç»Ÿæ­£åœ¨ç»´æŠ¤ä¸­ï¼Œè¯·ç¨åå†è¯•"
}
```

### å›¾ç‰‡é…ç½®ç¤ºä¾‹ â­ æ–°å¢
```json
{
  "ui.login_bg": "/assets/images/login_bg.jpg",
  "ui.app_icon": "https://cdn.example.com/app_icon.png",
  "ui.banner_image": "/assets/images/banner.webp"
}
```

## ğŸ–¼ï¸ å›¾ç‰‡ä¸Šä¼ å®Œæ•´æµç¨‹

### 1. å›¾ç‰‡ä¸Šä¼ æ­¥éª¤

#### **ç¬¬ä¸€æ­¥ï¼šè·å–å›¾ç‰‡ä¸Šä¼ åœ°å€**
```bash
GET /v1/file/upload?type=common&path=/admin/config/logo.png
```

**è¯·æ±‚å‚æ•°**:
- `type`: æ–‡ä»¶ç±»å‹ï¼Œå»ºè®®ä½¿ç”¨ `common`ï¼ˆé€šç”¨ï¼‰
- `path`: å›¾ç‰‡ä¿å­˜è·¯å¾„ï¼Œå»ºè®®ä½¿ç”¨ `/admin/config/{é…ç½®é”®}` æ ¼å¼

**å“åº”ç¤ºä¾‹**:
```json
{
  "url": "http://api.example.com/v1/file/upload?type=common&path=/admin/config/logo.png"
}
```

#### **ç¬¬äºŒæ­¥ï¼šä¸Šä¼ å›¾ç‰‡æ–‡ä»¶**
```bash
POST /v1/file/upload?type=common&path=/admin/config/logo.png
Content-Type: multipart/form-data

file: [å›¾ç‰‡æ–‡ä»¶]
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "path": "file/preview/common/admin/config/logo.png"
}
```

#### **ç¬¬ä¸‰æ­¥ï¼šä¿å­˜å›¾ç‰‡è·¯å¾„åˆ°é…ç½®**
```bash
POST /v1/manager/config/create
Content-Type: application/json
Authorization: Bearer {token}

{
  "config_key": "ui.site_logo",
  "config_value": "file/preview/common/admin/config/logo.png",
  "config_type": "image",
  "description": "ç½‘ç«™Logoå›¾ç‰‡",
  "category": "ui",
  "is_editable": 1,
  "is_public": 1,
  "sort_order": 100
}
```

### 2. å›¾ç‰‡ä¸Šä¼ æœ€ä½³å®è·µ

#### **è·¯å¾„å‘½åè§„èŒƒ**
```
/admin/config/{åˆ†ç±»}/{é…ç½®é”®}.{æ‰©å±•å}

ç¤ºä¾‹ï¼š
/admin/config/ui/site_logo.png
/admin/config/ui/login_bg.jpg
/admin/config/ui/banner_image.webp
/admin/config/system/app_icon.svg
```

#### **æ”¯æŒçš„å›¾ç‰‡æ ¼å¼**
- **æ¨èæ ¼å¼**: PNGã€JPGã€WebP
- **æ”¯æŒæ ¼å¼**: JPEGã€GIFã€BMPã€SVG
- **æ–‡ä»¶å¤§å°**: å»ºè®®ä¸è¶…è¿‡ 10MB

#### **å›¾ç‰‡ç±»å‹é…ç½®å»ºè®®**
```json
{
  "ui.site_logo": "file/preview/common/admin/config/ui/site_logo.png",
  "ui.login_background": "file/preview/common/admin/config/ui/login_bg.jpg",
  "ui.banner_image": "file/preview/common/admin/config/ui/banner.webp"
}
```

### 3. å‰ç«¯å®ç°è¦ç‚¹

#### **å›¾ç‰‡ä¸Šä¼ ç»„ä»¶**
- å°è£…å›¾ç‰‡ä¸Šä¼ é€»è¾‘ï¼ŒåŒ…å«è·å–ä¸Šä¼ åœ°å€ã€ä¸Šä¼ æ–‡ä»¶ã€ä¿å­˜é…ç½®ä¸‰ä¸ªæ­¥éª¤
- æ”¯æŒé”™è¯¯å¤„ç†å’Œç”¨æˆ·æç¤º
- å¯å¤ç”¨ï¼Œæ”¯æŒä¸åŒé…ç½®é”®å’Œåˆ†ç±»

#### **å›¾ç‰‡é¢„è§ˆç»„ä»¶**
- æ ¹æ® `config_type = "image"` è‡ªåŠ¨è¯†åˆ«å›¾ç‰‡é…ç½®é¡¹
- æ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆå’Œæ›´æ¢æŒ‰é’®
- å…¶ä»–ç±»å‹é…ç½®é¡¹ä½¿ç”¨é»˜è®¤çš„è¾“å…¥ç»„ä»¶æ¸²æŸ“

#### **å‰ç«¯å›¾ç‰‡é¢„è§ˆå®ç°**

##### **å›¾ç‰‡é¢„è§ˆURLæ‹¼æ¥**
```javascript
// ä¸Šä¼ æˆåŠŸåè¿”å›çš„path
const path = "file/preview/common/admin/config/system/system.site_logo.png";

// æ‹¼æ¥å®Œæ•´çš„é¢„è§ˆURL
const baseURL = "http://localhost:8090/v1"; // æ ¹æ®ç¯å¢ƒé…ç½®
const imageURL = `${baseURL}/${path}`;

// ç»“æœ: http://localhost:8090/v1/file/preview/common/admin/config/system/system.site_logo.png
```

##### **åœ¨HTMLä¸­ç›´æ¥ä½¿ç”¨**
```html
<img src="http://localhost:8090/v1/file/preview/file/preview/common/admin/config/system/system.site_logo.png" 
     alt="ç³»ç»ŸLogo" 
     style="max-width: 200px; height: auto;">
```

##### **åŠ¨æ€è®¾ç½®å›¾ç‰‡æº**
```javascript
// æ ¹æ®é…ç½®ç±»å‹è‡ªåŠ¨æ¸²æŸ“å›¾ç‰‡
function renderConfigItem(config) {
  if (config.config_type === 'image') {
    // å›¾ç‰‡ç±»å‹ï¼šæ˜¾ç¤ºå›¾ç‰‡é¢„è§ˆ
    return `<img src="${baseURL}/${config.config_value}" alt="${config.description}">`;
  } else {
    // å…¶ä»–ç±»å‹ï¼šæ˜¾ç¤ºè¾“å…¥æ¡†
    return `<input type="text" value="${config.config_value}">`;
  }
}
```

##### **å›¾ç‰‡é¢„è§ˆæ¥å£è¯´æ˜**
- **æ¥å£åœ°å€**: `GET /v1/file/preview/*path`
- **æ— éœ€è®¤è¯**: å…¬å¼€æ¥å£ï¼Œå¯ç›´æ¥è®¿é—®
- **è‡ªåŠ¨é‡å®šå‘**: æ¥å£ä¼šè‡ªåŠ¨é‡å®šå‘åˆ°å®é™…çš„æ–‡ä»¶å­˜å‚¨åœ°å€
- **æ”¯æŒç¼“å­˜**: æµè§ˆå™¨ä¼šè‡ªåŠ¨ç¼“å­˜å›¾ç‰‡ï¼Œæé«˜åŠ è½½é€Ÿåº¦

### 4. å›¾ç‰‡é…ç½®ç®¡ç†æµç¨‹

#### **å®Œæ•´çš„ç®¡ç†æµç¨‹**
1. **åˆ›å»ºå›¾ç‰‡é…ç½®é¡¹**
   - è®¾ç½® `config_type = "image"`
   - è®¾ç½®åˆé€‚çš„åˆ†ç±»å’Œæè¿°
   - è®¾ç½®æƒé™å’Œå¯è§æ€§

2. **ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶**
   - ä½¿ç”¨æ–‡ä»¶ä¸Šä¼ æ¥å£ä¸Šä¼ å›¾ç‰‡
   - è·å–è¿”å›çš„æ–‡ä»¶è·¯å¾„

3. **æ›´æ–°é…ç½®å€¼**
   - å°†æ–‡ä»¶è·¯å¾„ä¿å­˜åˆ°é…ç½®é¡¹
   - æ”¯æŒå›¾ç‰‡é¢„è§ˆå’Œæ›´æ¢

4. **å›¾ç‰‡è®¿é—®**
   - é€šè¿‡ `/v1/file/preview/` æ¥å£è®¿é—®å›¾ç‰‡
   - æ”¯æŒCDNåŠ é€Ÿå’Œç¼“å­˜

#### **å›¾ç‰‡é…ç½®æ›´æ–°æµç¨‹**
1. ä¸Šä¼ æ–°å›¾ç‰‡åˆ°æ–‡ä»¶æœåŠ¡
2. ä½¿ç”¨é…ç½®æ›´æ–°æ¥å£æ›´æ–°é…ç½®å€¼
3. åˆ·æ–°é¡µé¢æ˜¾ç¤ºæ–°çš„å›¾ç‰‡

## âš ï¸ é”™è¯¯ç è¯´æ˜

| é”™è¯¯ç  | è¯´æ˜ | è§£å†³æ–¹æ¡ˆ |
|--------|------|----------|
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ | æ£€æŸ¥è¯·æ±‚å‚æ•°æ ¼å¼å’Œå¿…å¡«é¡¹ |
| 401 | æœªæˆæƒ | æ£€æŸ¥JWT Tokenæ˜¯å¦æœ‰æ•ˆ |
| 403 | æƒé™ä¸è¶³ | ç¡®è®¤ç”¨æˆ·å…·æœ‰è¶…çº§ç®¡ç†å‘˜æƒé™ |
| 404 | é…ç½®ä¸å­˜åœ¨ | æ£€æŸ¥é…ç½®é”®æ˜¯å¦æ­£ç¡® |
| 409 | é…ç½®é”®å·²å­˜åœ¨ | æ–°å¢é…ç½®æ—¶é…ç½®é”®é‡å¤ï¼Œè¯·ä½¿ç”¨å…¶ä»–é”®å |
| 422 | é…ç½®å€¼éªŒè¯å¤±è´¥ | æ£€æŸ¥é…ç½®å€¼æ˜¯å¦ç¬¦åˆé…ç½®ç±»å‹è¦æ±‚ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ | æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯ |

## ğŸš« åˆ é™¤é™åˆ¶è¯´æ˜

ä»¥ä¸‹ç±»å‹çš„é…ç½®é¡¹ä¸å…è®¸åˆ é™¤ï¼š
- ç³»ç»Ÿæ ¸å¿ƒé…ç½®ï¼ˆå¦‚ï¼š`system.site_name`ã€`system.site_logo`ï¼‰
- å®‰å…¨å…³é”®é…ç½®ï¼ˆå¦‚ï¼š`security.password_min_length`ï¼‰
- åªè¯»é…ç½®ï¼ˆ`is_editable = 0`ï¼‰
- æ­£åœ¨è¢«ä½¿ç”¨çš„é…ç½®é¡¹

## ğŸ”§ å‰ç«¯é›†æˆå»ºè®®

### 1. Tabåˆ‡æ¢å®ç°
```javascript
// è·å–é…ç½®åˆ†ç±»
const categories = await api.get('/config/categories');

// æ ¹æ®åˆ†ç±»è·å–é…ç½®
const configs = await api.get(`/config/category/${category}`);

// æ¸²æŸ“é…ç½®è¡¨å•
renderConfigForm(configs);
```

### 2. é…ç½®æ›´æ–°
```javascript
// å•ä¸ªæ›´æ–°
await api.put('/config/update', {
  config_key: 'group.notify_member_join',
  config_value: '0'
});

// æ‰¹é‡æ›´æ–°
await api.put('/config/batch-update', {
  configs: [
    { config_key: 'key1', config_value: 'value1' },
    { config_key: 'key2', config_value: 'value2' }
  ]
});
```

### 3. æœç´¢åŠŸèƒ½
```javascript
const result = await api.post('/config/search', {
  keyword: 'ç¾¤ç»„',
  category: 'group',
  page: 1,
  page_size: 20
});
```

### 4. æ–°å¢é…ç½®
```javascript
// åˆ›å»ºæ–°é…ç½®é¡¹
const newConfig = await api.post('/config/create', {
  config_key: 'system.new_feature',
  config_value: '1',
  config_type: 'boolean',
  description: 'æ–°åŠŸèƒ½å¼€å…³',
  category: 'system'
});

// åˆ›å»ºå›¾ç‰‡ç±»å‹é…ç½®
const imageConfig = await api.post('/config/create', {
  config_key: 'ui.banner_image',
  config_value: '/assets/images/banner.png',
  config_type: 'image',
  description: 'é¦–é¡µæ¨ªå¹…å›¾ç‰‡',
  category: 'ui'
});
```

### 5. åˆ é™¤é…ç½®
```javascript
// åˆ é™¤å•ä¸ªé…ç½®é¡¹
await api.delete('/config/delete/system.temp_config');

// æ‰¹é‡åˆ é™¤é…ç½®é¡¹
const deleteResult = await api.delete('/config/batch-delete', {
  config_keys: ['system.temp_config1', 'system.temp_config2']
});
```

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–å»ºè®®

1. **ç¼“å­˜ç­–ç•¥**: ä¸ºé…ç½®æ•°æ®æ·»åŠ Redisç¼“å­˜
2. **åˆ†é¡µåŠ è½½**: å¤§é‡é…ç½®æ—¶ä½¿ç”¨åˆ†é¡µåŠ è½½
3. **æŒ‰éœ€åŠ è½½**: æ ¹æ®tabåˆ‡æ¢æŒ‰éœ€åŠ è½½é…ç½®
4. **æ‰¹é‡æ“ä½œ**: å¤šä¸ªé…ç½®æ›´æ–°æ—¶ä½¿ç”¨æ‰¹é‡æ¥å£

## ğŸ–¼ï¸ å›¾ç‰‡ä¸Šä¼ æ³¨æ„äº‹é¡¹

### **æ–‡ä»¶å¤§å°é™åˆ¶**
- **å»ºè®®å¤§å°**: ä¸è¶…è¿‡ 10MB
- **æœ€å¤§é™åˆ¶**: å—å­˜å‚¨æœåŠ¡é…ç½®é™åˆ¶
- **ä¼˜åŒ–å»ºè®®**: ä¸Šä¼ å‰è¿›è¡Œå›¾ç‰‡å‹ç¼©

### **å›¾ç‰‡æ ¼å¼è¦æ±‚**
- **æ¨èæ ¼å¼**: PNGã€JPGã€WebP
- **æ”¯æŒæ ¼å¼**: JPEGã€GIFã€BMPã€SVG

### **å®‰å…¨è€ƒè™‘**
- **æ–‡ä»¶ç±»å‹**: ä»…æ”¯æŒå›¾ç‰‡æ ¼å¼
- **è·¯å¾„å®‰å…¨**: ä½¿ç”¨é¢„å®šä¹‰çš„ä¸Šä¼ è·¯å¾„
- **æƒé™æ§åˆ¶**: éœ€è¦ç®¡ç†å‘˜æƒé™

### **é”™è¯¯å¤„ç†è¦ç‚¹**
- æ–‡ä»¶å¤§å°æ£€æŸ¥ï¼šå»ºè®®ä¸è¶…è¿‡10MB
- æ–‡ä»¶ç±»å‹éªŒè¯ï¼šä»…æ”¯æŒå›¾ç‰‡æ ¼å¼
- ç”¨æˆ·å‹å¥½æç¤ºï¼šä½¿ç”¨Toastã€Alertç­‰ç»„ä»¶æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯

### **å›¾ç‰‡é¢„è§ˆä¼˜åŒ–è¦ç‚¹**
- æ‡’åŠ è½½ï¼šä½¿ç”¨IntersectionObserverå®ç°å›¾ç‰‡æ‡’åŠ è½½
- åŠ è½½å¤±è´¥å¤„ç†ï¼šæä¾›é»˜è®¤å›¾ç‰‡ä½œä¸ºå¤‡é€‰
- åŠ è½½çŠ¶æ€ç®¡ç†ï¼šæ˜¾ç¤ºåŠ è½½æˆåŠŸ/å¤±è´¥çŠ¶æ€

## ğŸ” è°ƒè¯•å’Œæµ‹è¯•

- ä½¿ç”¨Postmanæˆ–å…¶ä»–APIæµ‹è¯•å·¥å…·æµ‹è¯•æ¥å£
- æµ‹è¯•æƒé™æ§åˆ¶å’Œæ•°æ®éªŒè¯
- æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿæˆ–æŸ¥çœ‹æœåŠ¡å™¨æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚


